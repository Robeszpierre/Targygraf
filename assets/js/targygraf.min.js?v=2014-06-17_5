var snapshot_enabled=!1;Array.prototype.remove=function(){for(var t,e,a=arguments,s=a.length;s&&this.length;)for(t=a[--s];-1!==(e=this.indexOf(t));)this.splice(e,1);return this},function(t,e){function a(t,e,a){var s=".targygraf.hu",i="";if(null==a)i="; domain="+s+"; expires=Thu, 01 Jan 1970 00:00:00 GMT";else{var n=new Date;n.setDate(n.getDate()+a),i=escape(e)+"; domain="+s+"; expires="+n.toUTCString()}document.cookie=t+"="+i}function s(t){var e,a,s,i=document.cookie.split(";");for(e=0;e<i.length;e++)if(a=i[e].substr(0,i[e].indexOf("=")),s=i[e].substr(i[e].indexOf("=")+1),a=a.replace(/^\s+|\s+$/g,""),a==t)return unescape(s)}function i(){var t=s("targygraf_teljesitett"),e=s("targygraf_felvett"),i=s("targygraf_szabad"),r=!1;t&&(n("targygraf-teljesitett",t.split(",")),a("targygraf_teljesitett","",null),r=!0),e&&(n("targygraf-teljesitett",e.split(",")),a("targygraf_felvett","",null),r=!0),i&&(n("targygraf-szabad",parseInt(i)),a("targygraf_szabad","",null),r=!0),r&&window.ga("send","event","migrate","cookie - localstorage")}function n(t,e){localStorage.setItem(t,JSON.stringify(e))}function r(t){return JSON.parse(localStorage.getItem(t))}function l(t){localStorage.removeItem(t)}function d(){clearTimeout(F),e("#kredit_teljesitett").html("Teljesített: <b>"+(S+D)+" kredit</b>"),e("#kredit_felvett").html("Felvett: <b>"+J+" kredit</b>"),F=setTimeout(function(){var t=e("#progressbar").width(),a=S+J+D,s=c();if(s){var i=Math.round(a/s*1e3)/10;e("#progressbar").attr("title",i+" %");var n=(S+D)/s*t,r=J/s*t;e("#kesz_progress").stop(!0,!0).animate({width:n},400).html("<b>"+(S+D)+"</b> kredit"),e("#felvett_progress").stop(!0,!0).animate({width:r},400).html("<b>"+J+"</b> kredit")}},250)}function o(){e(".content").each(function(){var t=0;e(this).children(".felev").each(function(){var a=e(this).children(".felev-title").height()+2;a>t&&(t=a)}),e(this).find(".felev-title").height(t)})}function f(){var t=960,a=e('.content[data-specialis="0"] .felev').length,s=e('.content[data-specialis="1"] .felev').length;a+s&&(t=145*(a>s?a:s)),e("#help").length&&(t+=2*e("#help").width()),e("body").css("min-width",t+"px")}function h(){e('.content[data-specialis="0"] .targy[data-elofeltetelek-szama!="0"]').each(function(){var t=e('.targy[data-elofeltetelek*="'+e(this).data("id")+'"]');0==t.length&&e(this).addClass("end")})}function c(){var t=0;return e('.content[data-specialis="0"] .targy').each(function(){"Szakirány"!=e(this).parents(".felev").children(".felev-title").text().trim()&&(t+=parseInt(e(this).data("kredit")))}),t}function u(){var t=[];e('.targy[data-kod="reference"]').each(function(){var a=e(this).data("references");a.length&&-1==t.indexOf(a)&&t.push(a)});for(var a=0,s=0;s<t.length;s++){for(var i=0,n=0,r=t[s].split(","),l=0;l<r.length;l++)e('.felev[data-id="'+r[l]+'"]').removeClass("felev-teljesitett"),e('.felev[data-id="'+r[l]+'"] .targy.teljesitett').each(function(){i+=parseInt(e(this).data("kredit"))});var o=e('.targy[data-references="'+t[s]+'"]');if(o.each(function(){n+=parseInt(e(this).data("kredit"))}),i>=n){a+=i-n;for(var l=0;l<r.length;l++)e('.felev[data-id="'+r[l]+'"]').addClass("felev-teljesitett")}o.sort(function(t,a){return parseInt(e(t).data("kredit"))<parseInt(e(a).data("kredit"))}).each(function(){e(this).removeClass("teljesitett");var t=parseInt(e(this).data("kredit"));i>=t&&(e(this).addClass("teljesitett"),i-=t)})}a>=0&&(N=a,j(),x(),d())}function g(t,a,s){var i=e('.targy[data-elofeltetelek*="'+t.data("id")+'"]'),n=[],r=[];i.length&&i.each(function(){e(this).hasClass("felvett")&&n.push(e(this)),e(this).hasClass("teljesitett")&&r.push(e(this))});var l="";if(n.length){l+="Kérlek távolítsd el a következő felvételeket:\n";for(var d=0;d<n.length;d++)l+="- "+n[d].text().trim()+"\n"}if(r.length){l+="Kérlek távolítsd el a következő teljesítéseket:\n";for(var d=0;d<r.length;d++)l+="- "+r[d].text().trim()+"\n"}if(l.length)return void alert(l);var o=parseInt(t.data("kredit"));("undefined"==typeof a||a)&&(S-=o),("undefined"==typeof s||s)&&P.remove(t.data("id")),t.removeClass("teljesitett").addClass("felveheto"),"1"==t.parents(".content").data("specialis")&&u()}function v(t,e,a,s,i){if("reference"!=t.data("kod")&&"szabad"!=t.data("kod")){var n=parseInt(t.data("kredit"));("undefined"==typeof e||e)&&(S+=n),("undefined"==typeof a||a)&&(J-=n),("undefined"==typeof s||s)&&P.push(t.data("id")),("undefined"==typeof i||i)&&B.remove(t.data("id")),t.removeClass("felvett").addClass("teljesitett"),"1"==t.parents(".content").data("specialis")&&u()}}function p(t,e,a){if("reference"!=t.data("kod")&&"szabad"!=t.data("kod")){var s=parseInt(t.data("kredit"));("undefined"==typeof e||e)&&(J+=s),("undefined"==typeof a||a)&&B.push(t.data("id")),t.removeClass("felveheto").addClass("felvett")}}function k(t){if("reference"==t.data("kod")||"szabad"==t.data("kod"))return!1;if(t.hasClass("felvett"))return!1;if(t.hasClass("teljesitett"))return!1;if("0"!=t.data("elofeltetelek-szama"))for(var a=t.data("elofeltetelek").split(","),s=0;s<a.length;s++)if(a[s]==K){if(75>S+D+N)return!1}else if(a[s]==M){if(20>S+D+N)return!1}else if(a[s]==$){if(120>S+D+N)return!1}else if(a[s]==A){if(130>S+D+N)return!1}else if("#"==a[s][0]){if(!e('.targy[data-id="'+a[s].substring(1)+'"]').hasClass("felvett")&&!e('.targy[data-id="'+a[s].substring(1)+'"]').hasClass("teljesitett"))return!1}else if(!e('.targy[data-id="'+a[s]+'"]').hasClass("teljesitett"))return!1;return!0}function y(t){e('.targy[data-elofeltetelek*="'+t.data("id")+'"]').addClass("raepules")}function m(t){if("0"!=t.data("elofeltetelek-szama"))for(var a=t.data("elofeltetelek").split(","),s=0;s<a.length;s++)"#"==a[s][0]&&(a[s]=a[s].substring(1)),e('.targy[data-id="'+a[s]+'"]').addClass("elofeltetel")}function b(){e(".targy.raepules").removeClass("raepules"),e(".targy.elofeltetel").removeClass("elofeltetel")}function z(t,a){for(var s=t.data("references").split(","),i=0;i<s.length;i++){var n=e('.felev[data-id="'+s[i]+'"]');a?n.css("z-index","101").css("background-color","white"):n.css("z-index","").css("background-color","")}}function C(){e(".targy").each(function(){k(e(this))?e(this).addClass("felveheto"):e(this).removeClass("felveheto")})}function w(){return snapshot_enabled?void e("#share").hide():void(P.length||B.length?e("#share").show():e("#share").hide())}function _(){return snapshot_enabled?void e("#reset").hide():void(P.length||B.length?e("#reset").show():e("#reset").hide())}function j(){e("#kredit_overflow").html(N>0?" [+ "+N+" kredit]":"")}function x(){var t=D+N;e('.targy[data-kod="szabad"]').sort(function(t,a){return parseInt(e(t).data("kredit"))<parseInt(e(a).data("kredit"))}).each(function(){e(this).removeClass("teljesitett");var a=parseInt(e(this).data("kredit"));t>=a&&(e(this).addClass("teljesitett"),"0"==e(this).parents(".content").data("specialis")&&(t-=a))}),e("#kredit_szabad").text(D),D?e("#kredit_szabad-minus").removeClass("muted"):e("#kredit_szabad-minus").addClass("muted")}function T(){var t=snapshot_enabled?snapshot_teljesitett:r("targygraf-teljesitett"),a=snapshot_enabled?snapshot_felvett:r("targygraf-felvett"),s=snapshot_enabled?snapshot_szabad:r("targygraf-szabad");if(t)for(var i=0;i<t.length;i++){var n=e('.targy[data-id="'+t[i]+'"]');n.length?v(e(n),!0,!1,!0,!1):P.push(t[i])}if(a)for(var i=0;i<a.length;i++){var n=e('.targy[data-id="'+a[i]+'"]');n.length?p(e(n),!0,!0):B.push(a[i])}D=s?s:0,x()}function I(){n("targygraf-teljesitett",P),n("targygraf-felvett",B),n("targygraf-szabad",D)}function O(){var t={};e(".targy").click(function(){if(!snapshot_enabled){var a=e(this).data("id"),s=e(this).text().trim();"reference"!=e(this).data("kod")&&"szabad"!=e(this).data("kod")&&(e(this).hasClass("teljesitett")?(g(e(this)),t.hasOwnProperty(a)&&clearTimeout(t[a]),t[a]=setTimeout(function(){window.ga("send","event","Tantárgy","Leadás",s)},1500)):e(this).hasClass("felvett")?(v(e(this)),t.hasOwnProperty(a)&&clearTimeout(t[a]),t[a]=setTimeout(function(){window.ga("send","event","Tantárgy","Teljesítés",s)},1500)):k(e(this))&&(p(e(this)),t.hasOwnProperty(a)&&clearTimeout(t[a]),t[a]=setTimeout(function(){window.ga("send","event","Tantárgy","Felvétel",s)},1500)),C(),w(),_(),d(),I())}}),e(".targy").hover(function(){y(e(this)),m(e(this))},function(){b()}),e('.targy[data-kod="reference"]').hover(function(){e(this).css("z-index","101"),e("#takar").show(),z(e(this),!0)},function(){z(e(this),!1),e("#takar").hide(),e(this).css("z-index","")}),e('.targy[data-kod="szabad"]').hover(function(){e(this).css("z-index","101"),e("#takar").show(),e("#kredit_szabad-highlight").css("z-index","101").css("background-color","white")},function(){e("#kredit_szabad-highlight").css("z-index","").css("background-color",""),e("#takar").hide(),e(this).css("z-index","")}),e("#kredit_szabad-minus").click(function(){e(this).hasClass("muted")||snapshot_enabled||(D--,x(),d(),I())}),e("#kredit_szabad-plus").click(function(){snapshot_enabled||(D++,x(),d(),I())}),e("#lenyit").click(function(){e(this).hide(),e("#szakok").show()}),e("#reset").click(function(){confirm("Biztos vagy benne?")&&(l("teljesitett"),l("felvett"),l("szabad"),location.reload())}),e("#share").click(function(){if(!e(this).hasClass("loading")){var t=e(this).data("url"),a=e(this).data("szak"),s=e(this).html(),i=this;e(this).addClass("loading"),e(this).html('<i class="fa fa-fw fa-circle-o-notch fa-spin"></i>'),e.post(t,{szak:a,teljesitett:JSON.stringify(P),felvett:JSON.stringify(B),szabad:D},function(t){e(i).hide(),window.location=t.link},"json").always(function(){e(i).html(s),e(i).removeClass("loading")})}}),e("#gombok .gomb").tipsy({gravity:"e"}),e(".helptargy").tipsy({gravity:"w",html:!0}),e("[title]").tipsy({gravity:"s",html:!0})}var S=0,J=0,N=0,D=0,P=[],B=[],F=null,K="000001",M="000002",$="004171",A="005276";t.init=function(){console.log("Szekeres Bálint - http://valentinx.hu"),f(),o(),h(),i(),T(),C(),w(),_(),d(),O()}}(window.Targygraf=window.Targygraf||{},jQuery),$(document).ready(function(){Targygraf.init()});